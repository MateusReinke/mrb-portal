
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Portal MRB</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #111; color: white; }
        textarea { width: 100%; height: 200px; margin-top: 10px; }
        button { padding: 10px; margin-top: 10px; cursor: pointer; }
        #loginBox { margin-bottom: 20px; }
    </style>
</head>
<body>

<h1>Portal MRB</h1>

<div id="loginBox">
    <input type="password" id="password" placeholder="Senha admin">
    <button onclick="login()">Login</button>
</div>

<div id="editor" style="display:none;">
    <textarea id="content"></textarea><br>
    <button onclick="save()">Salvar</button>
</div>

<div id="viewer"></div>

<script>
let token = null;

async function login() {
    const password = document.getElementById("password").value;
    const res = await fetch("/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ password })
    });

    if (!res.ok) return alert("Senha incorreta");

    const data = await res.json();
    token = data.token;

    document.getElementById("loginBox").style.display = "none";
    document.getElementById("editor").style.display = "block";
}

async function loadContent() {
    const res = await fetch("/content");
    const data = await res.json();
    document.getElementById("viewer").innerHTML = "<h2>Conte√∫do Atual:</h2>" + data.content;
    document.getElementById("content").value = data.content;
}

async function save() {
    await fetch("/content", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": token
        },
        body: JSON.stringify({
            content: document.getElementById("content").value
        })
    });

    alert("Salvo com sucesso!");
    loadContent();
}

loadContent();
</script>

</body>
</html>
